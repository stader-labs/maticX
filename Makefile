# Binaries
BIN_HARDHAT := ./node_modules/.bin/hardhat
BIN_ECHIDNA := echidna
BIN_MYTH := myth

# Configs
CONFIG_ECHIDNA := echidna.config.yaml
CONFIG_SOLC := solc.json

# Networks
NETWORK_HARDHAT := hardhat
NETWORK_LOCALHOST := localhost
NETWORK_SEPOLIA := sepolia
NETWORK_AMOY := amoy
NETWORK_ETHEREUM := ethereum
NETWORK_POLYGON := polygon

# Hardhat contract addresses
HARDHAT_VALIDATOR_REGISTRY := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_MATIC_X := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_CHILD_POOL := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_STAKE_MANAGER := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_CHECKPOINT_MANAGER := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_FX_ROOT := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_FX_CHILD := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_FX_STATE_ROOT_TUNNEL := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_FX_STATE_CHILD_TUNNEL := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_MATIC_TOKEN := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_POL_TOKEN := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
HARDHAT_MANAGER := 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
HARDHAT_TREASURY := 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
HARDHAT_INSTANT_POOL_OWNER := 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266

# Localhost contract addresses
LOCALHOST_VALIDATOR_REGISTRY := 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
LOCALHOST_MATIC_X := 0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9
LOCALHOST_CHILD_POOL := 0xa513E6E4b8f2a923D98304ec87F64353C4D5C853
LOCALHOST_STAKE_MANAGER := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
LOCALHOST_CHECKPOINT_MANAGER := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
LOCALHOST_FX_ROOT := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
LOCALHOST_FX_CHILD := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
LOCALHOST_FX_STATE_ROOT_TUNNEL := 0xDc64a140Aa3E981100a9becA4E685f962f0cF6C9
LOCALHOST_FX_STATE_CHILD_TUNNEL := 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
LOCALHOST_MATIC_TOKEN := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
LOCALHOST_POL_TOKEN := 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
LOCALHOST_MANAGER := 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
LOCALHOST_TREASURY := 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
LOCALHOST_INSTANT_POOL_OWNER := 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266

# Sepolia contract addresses
SEPOLIA_VALIDATOR_REGISTRY := 0xE98fc808E8aE8025a1D17d6F4Fbc3Df226788438
SEPOLIA_MATIC_X := 0xB51AAb302085F436204c4B1964fBE74517B2D4b6
SEPOLIA_STAKE_MANAGER := 0x4AE8f648B1Ec892B6cc68C89cc088583964d08bE
SEPOLIA_CHECKPOINT_MANAGER := 0xbd07D7E1E93c8d4b2a261327F3C28a8EA7167209
SEPOLIA_FX_ROOT := 0x0E13EBEdDb8cf9f5987512d5E081FdC2F5b0991e
SEPOLIA_FX_STATE_ROOT_TUNNEL := 0x1316e16f56a5A05538277906E12b77F2B39B4d79
SEPOLIA_MATIC_TOKEN := 0x3fd0A53F4Bf853985a95F4Eb3F9C9FDE1F8e2b53
SEPOLIA_POL_TOKEN := 0x44499312f493F62f2DFd3C6435Ca3603EbFCeeBa
SEPOLIA_MANAGER := 0x369B31971250859d3AD37E7cEDCF42AA5CF2C4F4
SEPOLIA_TREASURY := 0xdeb90df43BBa8FC0e2C08C54dC0F48cfc694F896

# Amoy contract addresses
AMOY_MATIC_X := 0xFD837d45dd6Af18D039122301C3331D4A4307351
AMOY_CHILD_POOL := 0x54a994B66FA7eA7160D6281002B56a041db0b5a5
AMOY_FX_CHILD := 0xE5930336866d0388f0f745A2d9207C7781047C0f
AMOY_FX_STATE_CHILD_TUNNEL := 0xDC5e26af83c1694A655beBe22689f12A42573d94
AMOY_MANAGER := 0x8C6B3eE457b193A49794df466957441b4AccD102
AMOY_TREASURY := 0x8C6B3eE457b193A49794df466957441b4AccD102
AMOY_INSTANT_POOL_OWNER := 0x8C6B3eE457b193A49794df466957441b4AccD102

# Ethereum (Prod) contract addresses
ETHEREUM_PROD_VALIDATOR_REGISTRY := 0xf556442D5B77A4B0252630E15d8BbE2160870d77
ETHEREUM_PROD_MATIC_X := 0xf03A7Eb46d01d9EcAA104558C732Cf82f6B6B645
ETHEREUM_PROD_STAKE_MANAGER := 0x5e3ef299fddf15eaa0432e6e66473ace8c13d908
ETHEREUM_PROD_CHECKPOINT_MANAGER := 0x86e4dc95c7fbdbf52e33d563bbdb00823894c287
ETHEREUM_PROD_FX_ROOT := 0xfe5e5D361b2ad62c541bAb87C45a0B9B018389a2
ETHEREUM_PROD_FX_STATE_ROOT_TUNNEL := 0x40FB804Cc07302b89EC16a9f8d040506f64dFe29
ETHEREUM_PROD_MATIC_TOKEN := 0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0
ETHEREUM_PROD_POL_TOKEN := 0x455e53CBB86018Ac2B8092FdCd39d8444aFFC3F6
ETHEREUM_PROD_MANAGER := 0x80A43dd35382C4919991C5Bca7f46Dd24Fde4C67
ETHEREUM_PROD_TREASURY := 0x01422247a1d15BB4FcF91F5A077Cf25BA6460130

# Ethereum (Staging) contract addresses
ETHEREUM_STAGING_VALIDATOR_REGISTRY := 0xcEbaFD96Df8a1Cc63ee77770296F14B68089Ab04
ETHEREUM_STAGING_MATIC_X := 0xD22dd194B8ec2abEeeFAC36a69cd8898FB6C43b3
ETHEREUM_STAGING_STAKE_MANAGER := 0x5e3ef299fddf15eaa0432e6e66473ace8c13d908
ETHEREUM_STAGING_CHECKPOINT_MANAGER := 0x86e4dc95c7fbdbf52e33d563bbdb00823894c287
ETHEREUM_STAGING_FX_ROOT := 0xfe5e5D361b2ad62c541bAb87C45a0B9B018389a2
ETHEREUM_STAGING_FX_STATE_ROOT_TUNNEL := 
ETHEREUM_STAGING_MATIC_TOKEN := 0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0
ETHEREUM_STAGING_POL_TOKEN := 0x455e53CBB86018Ac2B8092FdCd39d8444aFFC3F6
ETHEREUM_STAGING_MANAGER := 0x6FCBE6C2d6f6c890fD0cC5b0288E2D474D90BB1F
ETHEREUM_STAGING_TREASURY := 0x6FCBE6C2d6f6c890fD0cC5b0288E2D474D90BB1F

# Polygon (Prod) contract addresses
POLYGON_PROD_MATIC_X := 0xfa68FB4628DFF1028CFEc22b4162FCcd0d45efb6
POLYGON_PROD_CHILD_POOL := 0xfd225C9e6601C9d38d8F98d8731BF59eFcF8C0E3
POLYGON_PROD_FX_CHILD := 0x8397259c983751DAf40400790063935a11afa28a
POLYGON_PROD_FX_STATE_CHILD_TUNNEL := 0x97E58a6950D86d751082D5e1d350e74c19047570
POLYGON_PROD_MANAGER := 0x80A43dd35382C4919991C5Bca7f46Dd24Fde4C67
POLYGON_PROD_TREASURY := 0x80A43dd35382C4919991C5Bca7f46Dd24Fde4C67
POLYGON_PROD_INSTANT_POOL_OWNER := 0x51358004cFe135E64453d7F6a0dC433CAba09A2a

# Polygon (Staging) contract addresses
POLYGON_STAGING_MATIC_X := 0x797Ea002716E9a91F764721bBf3C4F34548B87F8
POLYGON_STAGING_CHILD_POOL := 0x86182711ee76085444FD66E8a4d58A15f9b6EfAC
POLYGON_STAGING_FX_CHILD := 0x8397259c983751DAf40400790063935a11afa28a
POLYGON_STAGING_FX_STATE_CHILD_TUNNEL := 0x976BdbC06B84349C003A4C7Afeb2bAbdfd689bAa
POLYGON_STAGING_MANAGER := 0x6FCBE6C2d6f6c890fD0cC5b0288E2D474D90BB1F
POLYGON_STAGING_TREASURY := 0x6FCBE6C2d6f6c890fD0cC5b0288E2D474D90BB1F
POLYGON_STAGING_INSTANT_POOL_OWNER := 0x6FCBE6C2d6f6c890fD0cC5b0288E2D474D90BB1F

# Contract paths
CONTRACT_PATH_VALIDATOR_REGISTRY := contracts/ValidatorRegistry.sol
CONTRACT_PATH_MATIC_X := contracts/MaticX.sol
CONTRACT_PATH_CHILD_POOL := contracts/ChildPool.sol

all: hardhat

hardhat: deploy-validatorregistry-hardhat deploy-childpool-hardhat deploy-fxstateroottunnel-hardhat deploy-fxstatechildtunnel-hardhat

localhost: deploy-validatorregistry-localhost deploy-maticx-localhost deploy-fxstateroottunnel-localhost deploy-fxstatechildtunnel-localhost deploy-childpool-localhost

# Deploy the ValidatorRegistry contract
deploy-validatorregistry-hardhat:
	$(BIN_HARDHAT) deploy:validator-registry --network $(NETWORK_HARDHAT) --stake-manager $(HARDHAT_STAKE_MANAGER) --matic-token $(HARDHAT_MATIC_TOKEN) --matic-x $(HARDHAT_MATIC_X) --manager $(HARDHAT_MANAGER)
deploy-validatorregistry-localhost:
	$(BIN_HARDHAT) deploy:validator-registry --network $(NETWORK_LOCALHOST) --stake-manager $(LOCALHOST_STAKE_MANAGER) --matic-token $(LOCALHOST_MATIC_TOKEN) --matic-x $(LOCALHOST_MATIC_X) --manager $(LOCALHOST_MANAGER)
deploy-validatorregistry-sepolia:
	$(BIN_HARDHAT) deploy:validator-registry --network $(NETWORK_SEPOLIA) --stake-manager $(SEPOLIA_STAKE_MANAGER) --matic-token $(SEPOLIA_MATIC_TOKEN) --matic-x $(SEPOLIA_MATIC_X) --manager $(SEPOLIA_MANAGER)
deploy-validatorregistry-ethereum-prod:
	$(BIN_HARDHAT) deploy:validator-registry --network $(NETWORK_ETHEREUM) --stake-manager $(ETHEREUM_PROD_STAKE_MANAGER) --matic-token $(ETHEREUM_PROD_MATIC_TOKEN) --matic-x $(ETHEREUM_PROD_MATIC_X) --manager $(ETHEREUM_PROD_MANAGER)
deploy-validatorregistry-ethereum-staging:
	$(BIN_HARDHAT) deploy:validator-registry --network $(NETWORK_ETHEREUM) --stake-manager $(ETHEREUM_STAGING_STAKE_MANAGER) --matic-token $(ETHEREUM_STAGING_MATIC_TOKEN) --matic-x $(ETHEREUM_STAGING_MATIC_X) --manager $(ETHEREUM_STAGING_MANAGER)

# Deploy the MaticX contract
deploy-maticx-hardhat:
	$(BIN_HARDHAT) deploy:matic-x --network $(NETWORK_HARDHAT) --validator-registry $(HARDHAT_VALIDATOR_REGISTRY) --stake-manager $(HARDHAT_STAKE_MANAGER) --matic-token $(HARDHAT_MATIC_TOKEN) --manager $(HARDHAT_MANAGER) --treasury $(HARDHAT_TREASURY)
deploy-maticx-localhost:
	$(BIN_HARDHAT) deploy:matic-x --network $(NETWORK_LOCALHOST) --validator-registry $(LOCALHOST_VALIDATOR_REGISTRY) --stake-manager $(LOCALHOST_STAKE_MANAGER) --matic-token $(LOCALHOST_MATIC_TOKEN) --manager $(LOCALHOST_MANAGER) --treasury $(LOCALHOST_TREASURY)
deploy-maticx-sepolia:
	$(BIN_HARDHAT) deploy:matic-x --network $(NETWORK_SEPOLIA) --validator-registry $(SEPOLIA_VALIDATOR_REGISTRY) --stake-manager $(SEPOLIA_STAKE_MANAGER) --matic-token $(SEPOLIA_MATIC_TOKEN) --manager $(SEPOLIA_MANAGER) --treasury $(SEPOLIA_TREASURY)
deploy-maticx-amoy:
	$(BIN_HARDHAT) deploy:u-child-erc20 --network $(NETWORK_AMOY) --name "Liquid Staking Matic (PoS)" --symbol "MaticX" --child-chain-manager $(AMOY_MANAGER)
deploy-maticx-ethereum-prod:
	$(BIN_HARDHAT) deploy:matic-x --network $(NETWORK_ETHEREUM) --validator-registry $(ETHEREUM_PROD_VALIDATOR_REGISTRY) --stake-manager $(ETHEREUM_PROD_STAKE_MANAGER) --matic-token $(ETHEREUM_PROD_MATIC_TOKEN) --manager $(ETHEREUM_PROD_MANAGER) --treasury $(ETHEREUM_PROD_TREASURY)
deploy-maticx-ethereum-staging:
	$(BIN_HARDHAT) deploy:matic-x --network $(NETWORK_ETHEREUM) --validator-registry $(ETHEREUM_STAGING_VALIDATOR_REGISTRY) --stake-manager $(ETHEREUM_STAGING_STAKE_MANAGER) --matic-token $(ETHEREUM_STAGING_MATIC_TOKEN) --manager $(ETHEREUM_STAGING_MANAGER) --treasury $(ETHEREUM_STAGING_TREASURY)
deploy-maticx-polygon-prod:
	$(BIN_HARDHAT) deploy:u-child-erc20 --network $(NETWORK_POLYGON) --name "Liquid Staking Matic (PoS)" --symbol "MaticX" --child-chain-manager $(POLYGON_PROD_MANAGER)
deploy-maticx-polygon-staging:
	$(BIN_HARDHAT) deploy:u-child-erc20 --network $(NETWORK_POLYGON) --name "Liquid Staking Matic (PoS)" --symbol "MaticX" --child-chain-manager $(POLYGON_STAGING_MANAGER)

# Deploy an implementation of the MaticX contract
deployimplementation-maticx-localhost:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_LOCALHOST) --name MaticX
deployimplementation-maticx-sepolia:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_SEPOLIA) --name MaticX
deployimplementation-maticx-ethereum-prod:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_ETHEREUM) --name MaticX
deployimplementation-maticx-ethereum-staging:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_ETHEREUM) --name MaticX

# Deploy an implementation of the ValidatorRegistry contract
deployimplementation-validatorregistry-localhost:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_LOCALHOST) --name ValidatorRegistry
deployimplementation-validatorregistry-sepolia:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_SEPOLIA) --name ValidatorRegistry
deployimplementation-validatorregistry-ethereum-prod:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_ETHEREUM) --name ValidatorRegistry
deployimplementation-validatorregistry-ethereum-staging:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_ETHEREUM) --name ValidatorRegistry

# Deploy an implementation of the ChildPool contract
deployimplementation-childpool-localhost:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_LOCALHOST) --name ChildPool
deployimplementation-childpool-amoy:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_AMOY) --name ChildPool
deployimplementation-childpool-polygon-prod:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_POLYGON) --name ChildPool
deployimplementation-childpool-polygon-staging:
	$(BIN_HARDHAT) deploy-implementation --network $(NETWORK_POLYGON) --name ChildPool

# Deploy the ChildPool contract
deploy-childpool-hardhat:
	$(BIN_HARDHAT) deploy:child-pool --network $(NETWORK_HARDHAT) --fx-state-child-tunnel $(HARDHAT_FX_STATE_CHILD_TUNNEL) --matic-x $(HARDHAT_MATIC_X) --manager $(HARDHAT_MANAGER) --instant-pool-owner $(HARDHAT_INSTANT_POOL_OWNER) --treasury $(HARDHAT_TREASURY)
deploy-childpool-localhost:
	$(BIN_HARDHAT) deploy:child-pool --network $(NETWORK_LOCALHOST) --fx-state-child-tunnel $(LOCALHOST_FX_STATE_CHILD_TUNNEL) --matic-x $(LOCALHOST_MATIC_X) --manager $(LOCALHOST_MANAGER) --instant-pool-owner $(LOCALHOST_INSTANT_POOL_OWNER) --treasury $(LOCALHOST_TREASURY)
deploy-childpool-amoy:
	$(BIN_HARDHAT) deploy:child-pool --network $(NETWORK_AMOY) --fx-state-child-tunnel $(AMOY_FX_STATE_CHILD_TUNNEL) --matic-x $(AMOY_MATIC_X) --manager $(AMOY_MANAGER) --instant-pool-owner $(AMOY_INSTANT_POOL_OWNER) --treasury $(AMOY_TREASURY)
deploy-childpool-polygon-prod:
	$(BIN_HARDHAT) deploy:child-pool --network $(NETWORK_POLYGON) --fx-state-child-tunnel $(POLYGON_PROD_FX_STATE_CHILD_TUNNEL) --matic-x $(POLYGON_PROD_MATIC_X) --manager $(POLYGON_PROD_MANAGER) --instant-pool-owner $(POLYGON_PROD_INSTANT_POOL_OWNER) --treasury $(POLYGON_PROD_TREASURY)
deploy-childpool-polygon-staging:
	$(BIN_HARDHAT) deploy:child-pool --network $(NETWORK_POLYGON) --fx-state-child-tunnel $(POLYGON_STAGING_FX_STATE_CHILD_TUNNEL) --matic-x $(POLYGON_STAGING_MATIC_X) --manager $(POLYGON_STAGING_MANAGER) --instant-pool-owner $(POLYGON_STAGING_INSTANT_POOL_OWNER) --treasury $(POLYGON_STAGING_TREASURY)

# Deploy the FxStateRootTunnel contract
deploy-fxstateroottunnel-hardhat:
	$(BIN_HARDHAT) deploy:fx-state-root-tunnel --network $(NETWORK_HARDHAT) --checkpoint-manager $(HARDHAT_CHECKPOINT_MANAGER) --fx-root $(HARDHAT_FX_ROOT) --matic-x $(HARDHAT_MATIC_X)
deploy-fxstateroottunnel-localhost:
	$(BIN_HARDHAT) deploy:fx-state-root-tunnel --network $(NETWORK_LOCALHOST) --checkpoint-manager $(LOCALHOST_CHECKPOINT_MANAGER) --fx-root $(LOCALHOST_FX_ROOT) --matic-x $(LOCALHOST_MATIC_X)
deploy-fxstateroottunnel-sepolia:
	$(BIN_HARDHAT) deploy:fx-state-root-tunnel --network $(NETWORK_SEPOLIA) --checkpoint-manager $(SEPOLIA_CHECKPOINT_MANAGER) --fx-root $(SEPOLIA_FX_ROOT) --matic-x $(SEPOLIA_MATIC_X)
deploy-fxstateroottunnel-ethereum-prod:
	$(BIN_HARDHAT) deploy:fx-state-root-tunnel --network $(NETWORK_ETHEREUM) --checkpoint-manager $(ETHEREUM_PROD_CHECKPOINT_MANAGER) --fx-root $(ETHEREUM_PROD_FX_ROOT) --matic-x $(ETHEREUM_PROD_MATIC_X)
deploy-fxstateroottunnel-ethereum-staging:
	$(BIN_HARDHAT) deploy:fx-state-root-tunnel --network $(NETWORK_ETHEREUM) --checkpoint-manager $(ETHEREUM_STAGING_CHECKPOINT_MANAGER) --fx-root $(ETHEREUM_STAGING_FX_ROOT) --matic-x $(ETHEREUM_STAGING_MATIC_X)

# Deploy the FxStateChildTunnel contract
deploy-fxstatechildtunnel-hardhat:
	$(BIN_HARDHAT) deploy:fx-state-child-tunnel --network $(NETWORK_HARDHAT) --fx-child $(HARDHAT_FX_CHILD)
deploy-fxstatechildtunnel-localhost:
	$(BIN_HARDHAT) deploy:fx-state-child-tunnel --network $(NETWORK_LOCALHOST) --fx-child $(LOCALHOST_FX_CHILD)
deploy-fxstatechildtunnel-amoy:
	$(BIN_HARDHAT) deploy:fx-state-child-tunnel --network $(NETWORK_AMOY) --fx-child $(AMOY_FX_CHILD)
deploy-fxstatechildtunnel-polygon-prod:
	$(BIN_HARDHAT) deploy:fx-state-child-tunnel --network $(NETWORK_POLYGON) --fx-child $(POLYGON_PROD_FX_CHILD)
deploy-fxstatechildtunnel-polygon-staging:
	$(BIN_HARDHAT) deploy:fx-state-child-tunnel --network $(NETWORK_POLYGON) --fx-child $(POLYGON_STAGING_FX_CHILD)

# Initialize v2 the ValidatorRegistry contract
initializev2-validatorregistry-sepolia:
	$(BIN_HARDHAT) initialize-v2:validator-registry --network $(NETWORK_SEPOLIA) --contract $(SEPOLIA_VALIDATOR_REGISTRY) --pol-token $(SEPOLIA_POL_TOKEN)
initializev2-validatorregistry-ethereum-prod:
	$(BIN_HARDHAT) initialize-v2:validator-registry --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_PROD_VALIDATOR_REGISTRY) --pol-token $(ETHEREUM_PROD_POL_TOKEN)
initializev2-validatorregistry-ethereum-staging:
	$(BIN_HARDHAT) initialize-v2:validator-registry --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_STAGING_VALIDATOR_REGISTRY) --pol-token $(ETHEREUM_STAGING_POL_TOKEN)

# Initialize v2 the MaticX contract
initializev2-maticx-sepolia:
	$(BIN_HARDHAT) initialize-v2:matic-x --network $(NETWORK_SEPOLIA) --contract $(SEPOLIA_MATIC_X) --pol-token $(SEPOLIA_POL_TOKEN)
initializev2-maticx-ethereum-prod:
	$(BIN_HARDHAT) initialize-v2:matic-x --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_PROD_MATIC_X) --pol-token $(ETHEREUM_PROD_POL_TOKEN)
initializev2-maticx-ethereum-staging:
	$(BIN_HARDHAT) initialize-v2:matic-x --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_STAGING_MATIC_X) --pol-token $(ETHEREUM_STAGING_POL_TOKEN)

# Upgrade the ValidatorRegistry contract
upgrade-validatorregistry-localhost:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_LOCALHOST) --name ValidatorRegistry --contract $(LOCALHOST_VALIDATOR_REGISTRY)
upgrade-validatorregistry-sepolia:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_SEPOLIA) --name ValidatorRegistry --contract $(SEPOLIA_VALIDATOR_REGISTRY)
upgrade-validatorregistry-ethereum-prod:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_ETHEREUM) --name ValidatorRegistry --contract $(ETHEREUM_PROD_VALIDATOR_REGISTRY)
upgrade-validatorregistry-ethereum-staging:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_ETHEREUM) --name ValidatorRegistry --contract $(ETHEREUM_STAGING_VALIDATOR_REGISTRY)

# Upgrade the MaticX contract
upgrade-maticx-localhost:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_LOCALHOST) --name MaticX --contract $(LOCALHOST_MATIC_X) --unsafe true
upgrade-maticx-sepolia:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_SEPOLIA) --name MaticX --contract $(SEPOLIA_MATIC_X) --unsafe true
upgrade-maticx-ethereum-prod:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_ETHEREUM) --name MaticX --contract $(ETHEREUM_PROD_MATIC_X) --unsafe true
upgrade-maticx-ethereum-staging:
	$(BIN_HARDHAT) upgrade-contract --network $(NETWORK_ETHEREUM) --name MaticX --contract $(ETHEREUM_STAGING_MATIC_X) --unsafe true

# Verify the ValidatorRegistry contract
verify-validatorregistry-sepolia:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_SEPOLIA) --contract $(SEPOLIA_VALIDATOR_REGISTRY)
verify-validatorregistry-ethereum-prod:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_PROD_VALIDATOR_REGISTRY)
verify-validatorregistry-ethereum-staging:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_STAGING_VALIDATOR_REGISTRY)

# Verify the MaticX contract
verify-maticx-sepolia:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_SEPOLIA) --contract $(SEPOLIA_MATIC_X)
verify-maticx-amoy:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_AMOY) --contract $(AMOY_MATIC_X)
verify-maticx-ethereum-prod:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_PROD_MATIC_X)
verify-maticx-ethereum-staging:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_STAGING_MATIC_X)
verify-maticx-polygon-prod:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_POLYGON) --contract $(POLYGON_PROD_MATIC_X)
verify-maticx-polygon-staging:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_POLYGON) --contract $(POLYGON_STAGING_MATIC_X)

# Verify the ChildPool contract
verify-childpool-amoy:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_AMOY) --contract $(AMOY_CHILD_POOL)
verify-childpool-polygon-prod:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_POLYGON) --contract $(POLYGON_PROD_CHILD_POOL)
verify-childpool-polygon-staging:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_POLYGON) --contract $(POLYGON_STAGING_CHILD_POOL)

# Verify the FxStateRootTunnel contract
verify-fxstateroottunnel-sepolia:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_SEPOLIA) --contract $(SEPOLIA_FX_STATE_ROOT_TUNNEL) "$(SEPOLIA_CHECKPOINT_MANAGER)" "$(SEPOLIA_FX_ROOT)" "$(SEPOLIA_MATIC_X)"
verify-fxstateroottunnel-ethereum-prod:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_PROD_FX_STATE_ROOT_TUNNEL) "$(ETHEREUM_PROD_CHECKPOINT_MANAGER)" "$(ETHEREUM_PROD_FX_ROOT)" "$(ETHEREUM_PROD_MATIC_X)"
verify-fxstateroottunnel-ethereum-staging:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_ETHEREUM) --contract $(ETHEREUM_STAGING_FX_STATE_ROOT_TUNNEL) "$(ETHEREUM_STAGING_CHECKPOINT_MANAGER)" "$(ETHEREUM_STAGING_FX_ROOT)" "$(ETHEREUM_STAGING_MATIC_X)"

# Verify the FxStateChildTunnel contract
verify-fxstatechildtunnel-amoy:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_AMOY) --contract $(AMOY_FX_STATE_CHILD_TUNNEL) "$(AMOY_FX_CHILD)"
verify-fxstatechildtunnel-polygon-prod:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_POLYGON) --contract $(POLYGON_PROD_FX_STATE_CHILD_TUNNEL) "$(POLYGON_PROD_FX_CHILD)"
verify-fxstatechildtunnel-polygon-staging:
	$(BIN_HARDHAT) verify-contract --network $(NETWORK_POLYGON) --contract $(POLYGON_STAGING_FX_STATE_CHILD_TUNNEL) "$(POLYGON_STAGING_FX_CHILD)"

# Import the ValidatorRegistry contract
import-validatorregistry-sepolia:
	$(BIN_HARDHAT) import-contract --network $(NETWORK_SEPOLIA) --name ValidatorRegistry --contract $(SEPOLIA_VALIDATOR_REGISTRY)
import-validatorregistry-ethereum-prod:
	$(BIN_HARDHAT) import-contract --network $(NETWORK_ETHEREUM) --name ValidatorRegistry --contract $(ETHEREUM_PROD_VALIDATOR_REGISTRY)
import-validatorregistry-ethereum-staging:
	$(BIN_HARDHAT) import-contract --network $(NETWORK_ETHEREUM) --name ValidatorRegistry --contract $(ETHEREUM_STAGING_VALIDATOR_REGISTRY)

# Import the MaticX contract
import-maticx-sepolia:
	$(BIN_HARDHAT) import-contract --network $(NETWORK_SEPOLIA) --name MaticX --contract $(SEPOLIA_MATIC_X)
import-maticx-ethereum-prod:
	$(BIN_HARDHAT) import-contract --network $(NETWORK_ETHEREUM) --name MaticX --contract $(ETHEREUM_PROD_MATIC_X)
import-maticx-ethereum-staging:
	$(BIN_HARDHAT) import-contract --network $(NETWORK_ETHEREUM) --name MaticX --contract $(ETHEREUM_STAGING_MATIC_X)

# Analyze contracts with mythril
analyze-mytrhil-validatorregistry:
	$(BIN_MYTH) analyze $(CONTRACT_PATH_VALIDATOR_REGISTRY) --solc-json $(CONFIG_SOLC)
analyze-mytrhil-maticx:
	$(BIN_MYTH) analyze $(CONTRACT_PATH_MATIC_X) --solc-json $(CONFIG_SOLC)

# Fuzz test contracts with echidna
fuzz-echidna-maticx:
	$(BIN_ECHIDNA) . --contract FuzzMaticX $(CONFIG_ECHIDNA)
